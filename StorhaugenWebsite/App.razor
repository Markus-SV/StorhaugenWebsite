@using StorhaugenWebsite.Shared
@using MudBlazor

<MudThemeProvider @ref="_themeProvider" @bind-IsDarkMode="@_isDarkMode" Theme="_theme" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<Router AppAssembly="@typeof(App).Assembly">
    <Found Context="routeData">
        <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
        <FocusOnNavigate RouteData="@routeData" Selector="h1" />
    </Found>
    <NotFound>
        <PageTitle>Not found</PageTitle>
        <LayoutView Layout="@typeof(MainLayout)">
            <MudContainer MaxWidth="MaxWidth.Small" Class="d-flex flex-column align-center justify-center" Style="height: 60vh;">
                <MudIcon Icon="@Icons.Material.Filled.SearchOff" Size="Size.Large" Color="Color.Secondary" Class="mb-4" />
                <MudText Typo="Typo.h4" Class="mb-2">Page Not Found</MudText>
                <MudText Typo="Typo.body1" Color="Color.Secondary" Class="mb-4">The page you're looking for doesn't exist.</MudText>
                <MudButton Variant="Variant.Filled" Color="Color.Primary" Href="/">Go Home</MudButton>
            </MudContainer>
        </LayoutView>
    </NotFound>
</Router>

@code {
    private MudThemeProvider? _themeProvider;
    private bool _isDarkMode = false;

    private MudTheme _theme = new MudTheme()
    {
        PaletteLight = new PaletteLight()
        {
            Primary = "#E07A2E",
            PrimaryDarken = "#C56820",
            PrimaryLighten = "#F5A65B",
            Secondary = "#2D5A45",
            SecondaryDarken = "#1E3D2F",
            Tertiary = "#8B6914",
            Background = "#FBF8F4",
            Surface = "#FFFFFF",
            AppbarBackground = "#FFFFFF",
            AppbarText = "#2C2416",
            DrawerBackground = "#FFFFFF",
            TextPrimary = "#2C2416",
            TextSecondary = "#6B5D4D",
            ActionDefault = "#6B5D4D",
            Divider = "#E8E2D9",
            DividerLight = "#F0EBE4",
            Success = "#2D5A45",
            Warning = "#D4A017",
            Error = "#C44536",
            Info = "#4A7C9B"
        },
        PaletteDark = new PaletteDark()
        {
            Primary = "#F5A65B",
            PrimaryDarken = "#E07A2E",
            PrimaryLighten = "#FFCF9E",
            Secondary = "#5DBE8A",
            SecondaryDarken = "#2D5A45",
            Tertiary = "#D4A017",
            Background = "#1A1612",
            Surface = "#2C2416",
            AppbarBackground = "#2C2416",
            AppbarText = "#F5F0E8",
            DrawerBackground = "#2C2416",
            TextPrimary = "#F5F0E8",
            TextSecondary = "#A89B8A",
            ActionDefault = "#A89B8A",
            Divider = "#3D3428",
            DividerLight = "#4A3F32",
            Success = "#5DBE8A",
            Warning = "#F5C842",
            Error = "#E86B5B",
            Info = "#6BA3C7"
        },
        Typography = new Typography()
        {
            Default = new DefaultTypography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontSize = "1rem",
                FontWeight = "400",
                LineHeight = "1.5"
            },
            H1 = new H1Typography()
            {
                FontFamily = new[] { "Fraunces", "Georgia", "serif" },
                FontWeight = "600",
                FontSize = "2.5rem",
                LineHeight = "1.2"
            },
            H2 = new H2Typography()
            {
                FontFamily = new[] { "Fraunces", "Georgia", "serif" },
                FontWeight = "600",
                FontSize = "2rem",
                LineHeight = "1.25"
            },
            H3 = new H3Typography()
            {
                FontFamily = new[] { "Fraunces", "Georgia", "serif" },
                FontWeight = "600",
                FontSize = "1.75rem",
                LineHeight = "1.3"
            },
            H4 = new H4Typography()
            {
                FontFamily = new[] { "Fraunces", "Georgia", "serif" },
                FontWeight = "600",
                FontSize = "1.5rem",
                LineHeight = "1.35"
            },
            H5 = new H5Typography()
            {
                FontFamily = new[] { "Fraunces", "Georgia", "serif" },
                FontWeight = "600",
                FontSize = "1.25rem",
                LineHeight = "1.4"
            },
            H6 = new H6Typography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontWeight = "600",
                FontSize = "1.125rem",
                LineHeight = "1.4"
            },
            Subtitle1 = new Subtitle1Typography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontWeight = "500",
                FontSize = "1rem"
            },
            Subtitle2 = new Subtitle2Typography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontWeight = "500",
                FontSize = "0.875rem"
            },
            Body1 = new Body1Typography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontSize = "1rem",
                FontWeight = "400",
                LineHeight = "1.6"
            },
            Body2 = new Body2Typography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontSize = "0.875rem",
                FontWeight = "400",
                LineHeight = "1.5"
            },
            Button = new ButtonTypography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontWeight = "600",
                FontSize = "0.875rem",
                LetterSpacing = "0.02em",
                TextTransform = "none"
            },
            Caption = new CaptionTypography()
            {
                FontFamily = new[] { "DM Sans", "system-ui", "sans-serif" },
                FontSize = "0.75rem",
                FontWeight = "400"
            }
        },
        LayoutProperties = new LayoutProperties()
        {
            DefaultBorderRadius = "16px"
        }
    };

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && _themeProvider != null)
        {
            _isDarkMode = await _themeProvider.GetSystemDarkModeAsync();
            await InvokeAsync(StateHasChanged);
        }
    }
}